ä»¥ä¸‹æ˜¯ä½ æä¾›çš„è‹±æ–‡ cuBLAS ç³»åˆ— API è¯´æ˜ä¸æ€§èƒ½å»ºè®®çš„å®Œæ•´ä¸­æ–‡ç¿»è¯‘ï¼Œå¯ç”¨äºæ³¨é‡Šæˆ–æ–‡æ¡£ä¸­æ•´ç†ï¼š

---

## ğŸ”§ åŸºå‡†æµ‹è¯•å»ºè®®

> \*\*æ³¨æ„ï¼š\*\*åœ¨è¿è¡Œä¸»æµ‹å‰è¿›è¡Œé¢„çƒ­ï¼ˆwarmupï¼‰å’Œå¤šæ¬¡åŸºå‡†ï¼ˆbenchmarkï¼‰è¿è¡Œæ˜¯ç¡®ä¿æµ‹é‡æ—¶é—´å‡†ç¡®çš„å¥½æ–¹æ³•ã€‚
> å¦‚æœä¸è¿›è¡Œé¢„çƒ­ï¼ŒcuBLAS ç¬¬ä¸€æ¬¡è¿è¡Œçš„å¼€é”€ä¼šå¾ˆå¤§ï¼ˆå¤§çº¦æœ‰ 45msï¼‰ï¼Œè¿™ä¼šä¸¥é‡å½±å“ç»“æœçš„å‡†ç¡®æ€§ã€‚åŸºå‡†è¿è¡Œç”¨äºè·å–æ›´å¯é çš„å¹³å‡æ—¶é—´ã€‚

---

## ğŸ’  cuBLAS

* **NVIDIA CUDA åŸºæœ¬çº¿æ€§ä»£æ•°å­ç¨‹åºåº“ï¼ˆcuBLASï¼‰** æ˜¯ä¸€ä¸ª GPU åŠ é€Ÿåº“ï¼Œç”¨äºåŠ é€Ÿ AI ä¸é«˜æ€§èƒ½è®¡ç®—ï¼ˆHPCï¼‰åº”ç”¨ã€‚
* æä¾›æ ‡å‡† BLAS æ¥å£ä¸é«˜åº¦ä¼˜åŒ–çš„ GEMM æ¥å£ï¼ˆçŸ©é˜µä¹˜æ³•ï¼‰ï¼Œæ”¯æŒç®—å­èåˆï¼Œå¯¹ NVIDIA GPU æœ‰æ·±åº¦ä¼˜åŒ–ã€‚

ğŸ”— æ³¨æ„çŸ©é˜µç»´åº¦çš„é¡ºåºå’Œå­˜å‚¨æ ¼å¼é—®é¢˜ï¼ˆä¾‹å¦‚ï¼šè¡Œä¸»åºæˆ–åˆ—ä¸»åºï¼‰ï¼Œå‚è€ƒï¼š[StackOverflow è¯´æ˜](https://stackoverflow.com/questions/56043539/cublassgemm-row-major-multiplication)

---

## ğŸ’¡ cuBLAS-Ltï¼ˆLightweightï¼‰

* **cuBLASLt**ï¼ˆè½»é‡çº§ cuBLASï¼‰æ˜¯ cuBLAS çš„æ‰©å±•ç‰ˆæœ¬ï¼Œæä¾›æ›´çµæ´»çš„ APIï¼Œä¸»è¦é¢å‘æ·±åº¦å­¦ä¹ ç­‰ç‰¹å®šåœºæ™¯ä»¥è¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚
* å®ƒèƒ½å¤Ÿæ ¹æ®é—®é¢˜å¤æ‚åº¦è‡ªåŠ¨å°†çŸ©é˜µä¹˜æ³•ä»»åŠ¡æ‹†è§£ä¸ºå¤šä¸ªå­é—®é¢˜ï¼Œç”±å¤šä¸ªå†…æ ¸åˆ†åˆ«æ‰§è¡Œï¼Œæé«˜æ‰§è¡Œæ•ˆç‡ã€‚
* æ”¯æŒæ›´å¤šæ•°æ®ç±»å‹ï¼ˆå¦‚ FP16ã€FP8ã€INT8 ç­‰ï¼‰ï¼Œå¯¹æ·±åº¦å­¦ä¹ å‰å‘æ¨ç†å°¤å…¶é‡è¦ã€‚

---

## ğŸš€ cuBLAS-Xtï¼ˆMulti-GPU æ‰©å±•ï¼‰

* **cuBLASXt** æ˜¯ cuBLAS çš„å¤š GPU æ‰©å±•ç‰ˆæœ¬ï¼Œæ”¯æŒå°† BLAS æ“ä½œåˆ†é…åˆ°å¤šä¸ª GPU ä¸Šè¿è¡Œï¼Œé€‚ç”¨äºè¶…å¤§è§„æ¨¡è®¡ç®—ã€‚
* ç‰¹æ€§åŒ…æ‹¬ï¼š

  âœ… **å¤š GPU å¹¶è¡Œï¼š** æ”¯æŒå°†å¤§å‹çŸ©é˜µæ“ä½œåˆ†å¸ƒåœ¨å¤šä¸ª GPU ä¸Šæ‰§è¡Œï¼›
  âœ… **çº¿ç¨‹å®‰å…¨ï¼š** æ”¯æŒå¤šçº¿ç¨‹åŒæ—¶è°ƒç”¨å¤š GPU ä¸Šçš„æ“ä½œï¼›
  âœ… **ä¸»æœºæŒ‡é’ˆæ”¯æŒï¼š** å¯ç›´æ¥ä¼ å…¥ CPU å†…å­˜åœ°å€ï¼Œç”±æ¡†æ¶è‡ªåŠ¨å¤„ç†æ•°æ®åˆ†é…ä¸å¤åˆ¶ã€‚

ğŸ“Œ é€‚ç”¨äºï¼š**è¶…å‡ºå• GPU æ˜¾å­˜é™åˆ¶çš„å¤§è§„æ¨¡çº¿æ€§ä»£æ•°é—®é¢˜**
âš ï¸ ç¼ºç‚¹ï¼šæ•°æ®éœ€è¦åœ¨ä¸»æ¿ DRAM ä¸ GPU VRAM ä¹‹é—´ä¼ è¾“ï¼Œä¼šå¼•å…¥å¸¦å®½ç“¶é¢ˆï¼Œ**é€Ÿåº¦å¯èƒ½æ…¢äºå• GPU åŸç”Ÿ cuBLAS**ã€‚

### âœ… cuBLAS vs. cuBLASâ€‘Xt ç®€å•å¯¹æ¯”ï¼š

> ä»¥ `(M, N) Ã— (N, K)` çš„çŸ©é˜µä¹˜æ³•ï¼ŒM = N = K = 16384 ä¸ºä¾‹ï¼š
> ![cuBLAS-vs-cublasXt.png](../assets/cublas-vs-cublasxt.png)
> å¯¹äºå•å¡ç¯å¢ƒï¼ŒcuBLAS é€šå¸¸æ›´å¿«ï¼›cuBLASâ€‘Xt çš„ä¼˜åŠ¿ä½“ç°åœ¨**å¤šå¡å’Œè¶…å¤§çŸ©é˜µåœºæ™¯**ã€‚

---

## â›” cuBLASDxï¼ˆä¸åœ¨æœ¬é¡¹ç›®ä¸­ä½¿ç”¨ï¼‰

* **cuBLASDx** æ˜¯ä¸€ç§ **è®¾å¤‡ç«¯ API æ‰©å±•**ï¼Œå…è®¸åœ¨ CUDA æ ¸å‡½æ•°ä¸­ç›´æ¥æ‰§è¡Œ BLAS æ“ä½œï¼Œå®ç°**è¿ç®—èåˆ**ï¼Œè¿›ä¸€æ­¥é™ä½å»¶è¿Ÿã€æå‡æ€§èƒ½ã€‚
* ç”¨äºæç«¯æ€§èƒ½ä¼˜åŒ–éœ€æ±‚ä¸‹çš„è®¾å¤‡ç«¯çº¿æ€§ä»£æ•°å¤„ç†ã€‚

âš ï¸ æ³¨æ„ï¼šcuBLASDx å°šå¤„äºé¢„è§ˆé˜¶æ®µï¼Œå¹¶**ä¸åŒ…å«åœ¨ CUDA Toolkit ä¸­**ï¼Œéœ€[å•ç‹¬ä¸‹è½½](https://developer.nvidia.com/cublasdx-downloads)ã€‚
ğŸ“„ å®˜æ–¹æ–‡æ¡£ï¼š[cuBLASDx æ–‡æ¡£é“¾æ¥](https://docs.nvidia.com/cuda/cublasdx)

---

## âœ¨ CUTLASSï¼ˆå¯é€‰ä¼˜åŒ–å·¥å…·ï¼‰

* cuBLAS ç³»åˆ—åº“ä¸»è¦åœ¨ä¸»æœºç«¯è¿è¡Œï¼Œä¸æ˜“å®ç°æ“ä½œèåˆï¼ˆå¦‚ bias add + activationï¼‰ã€‚
* **CUTLASSï¼ˆCUDA æ¨¡æ¿åº“ï¼‰** ç”± NVIDIA æä¾›ï¼Œç”¨äºè‡ªå®šä¹‰çŸ©é˜µä¹˜æ³•å†…æ ¸ï¼Œå¯è½»æ¾å®ç°å¤æ‚çš„è¿ç®—èåˆä¸è°ƒä¼˜ã€‚
* åœ¨éœ€è¦çµæ´»æ§åˆ¶ kernel çš„æƒ…å†µä¸‹ä¼˜äº cuBLASã€‚

ğŸ“Œ æ³¨æ„ï¼šå¦‚ [FlashAttention](https://arxiv.org/pdf/2205.14135.pdf) è¿™ç§ä¼˜åŒ–ç®—æ³•**å¹¶æœªä½¿ç”¨ CUTLASS**ï¼Œè€Œæ˜¯æ‰‹å†™äº†æ›´é«˜æ•ˆçš„ CUDA kernelã€‚

> ![Flash Attention](../assets/flashattn.png)

---

éœ€è¦æˆ‘æŠŠè¿™äº›å†…å®¹æ•´ç†æˆ Markdown æ–‡ä»¶æˆ–ä½œä¸ºæ³¨é‡Šé™„åŠ åˆ°ä½ çš„ä»£ç ä¸­å—ï¼Ÿ
